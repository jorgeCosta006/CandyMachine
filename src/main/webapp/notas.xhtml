<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui">
<h:head>
	<div style="margin-bottom: 2%">
		<h:form>
			<b:navBar brand="Brand" brandHref="#" fluid="true">
				<b:navbarLinks>
					<b:navLink value="Link" href="#"></b:navLink>
				</b:navbarLinks>
				<b:navbarLinks pull="right">
					<b:navLink value="Link" href="#"></b:navLink>
				</b:navbarLinks>
			</b:navBar>

			<p:menubar style="background-color: white; border: none">
				<p:menuitem>
					<img
						src="https://i.pinimg.com/originals/a3/86/2e/a3862e78b02c0dd56965b330505cfb3d.png"
						alt="img" style="width: 180px"></img>
				</p:menuitem>
				<p:menuitem>
					<div style="margin-top: 50px">
						<p:commandLink action="#{userBean.changePage('mainPage')}"
							style="margin-right:20px;" ajax="false">
							<h:outputText value="Main Page" style="color: blue" />
						</p:commandLink>
					</div>
				</p:menuitem>
				<p:menuitem>
					<div style="margin-top: 50px">
						<p:commandLink action="#{userBean.changePage('historyPage')}"
							style="margin-right:20px;" ajax="false">
							<h:outputText value="History" />
						</p:commandLink>
					</div>
				</p:menuitem>
				<p:menuitem>
					<div style="margin-top: 50px">
						<p:commandLink
							action="#{userBean.changePage('configurationsPage')}"
							style="margin-right:20px;" ajax="false">
							<h:outputText value="Configurations" />
						</p:commandLink>
					</div>
				</p:menuitem>
				<p:menuitem rendered="#{userBean.role == 'ADMIN'}">
					<div style="margin-top: 50px">
						<p:commandLink action="#{userBean.changePage('moneyDepositPage')}"
							style="margin-right:20px;" ajax="false">
							<h:outputText value="Money Deposit" />
						</p:commandLink>
					</div>
				</p:menuitem>

				<f:facet name="options">
					<div style="margin-top: 50px">
						<p:outputLabel value="#{userBean.name}"></p:outputLabel>
						<b:button value="Default" look="danger" />
						<p:commandButton icon="fa-power-off" value="Logout"
							action="#{userBean.processLogout}" style="margin-left: 40px" />
					</div>
				</f:facet>
			</p:menubar>
		</h:form>
	</div>
</h:head>
<h:body>
	<div style="display: flex; flex-direction: column;">
		<div style="text-align: center; margin-bottom: 25px;">
			<h:form rendered="#{userBean.role == 'ADMIN'}">
				<p:commandButton value="Create candy"
					action="#{candyBean.candyToNull}"
					onclick="PF('createCandy').show()" />
			</h:form>
		</div>
		<div>
			<h:form>
				<div class="card" style="text-align: -webkit-center;">
					<p:dataTable var="product" value="#{machineBean.candies}"
						style="width: 1000px; text-align-last: center; box-shadow: 5px 6px 8px 0px #888888;">
						<p:column headerText="Name">
							<h:outputText value="#{product.name}" />
						</p:column>

						<p:column headerText="Quantity">
							<h:outputText value="#{product.quantity}" />
						</p:column>

						<p:column headerText="Price">
							<h:outputText value="#{product.price}" />
						</p:column>

						<p:column headerText="" rendered="#{userBean.role == 'CLIENT'}">
							<p:outputLabel rendered="#{product.quantity eq 0}"
								style="color: indianred">Unavailable</p:outputLabel>
							<p:commandButton value="Buy"
								action="#{machineBean.turnCoinsToZero(product)}"
								onclick="PF('coinModal').show()"
								rendered="#{product.quantity != 0}"
								style="background-image: none; background-color: #2487ec;" />
						</p:column>
						<p:column headerText="" rendered="#{userBean.role == 'ADMIN'}">
							<p:commandButton value="Edit"
								action="#{candyBean.receiveCandyObject(product)}"
								onclick="PF('updateCandy').show()"
								style="background-image: none; background-color: #2487ec;" />
							<p:commandButton value="Delete"
								action="#{candyBean.receiveCandyObject(product)}"
								onclick="PF('deleteModal').show()"
								style="background-image: none; background-color: #f54658;" />
						</p:column>
					</p:dataTable>
				</div>
			</h:form>
		</div>
	</div>

	<!--                        COIN MODAL                                      -->
	<h:form>
		<p:dialog id="createUserModal" modal="true" widgetVar="coinModal"
			resizable="false" stylr="position:absolute;" header="Insert coins"
			style="border-radius: 10px">
			<h:panelGrid columns="2" id="createUserPanel">
				<h:outputText value="Money: " />
				<h:outputText id="coin" value="#{machineBean.totalMoney}" />

				<p:commandButton value="0.05" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('0.05')}" update="coin" />
				<p:commandButton value="0.10" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('0.10')}" update="coin" />
				<p:commandButton value="0.20" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('0.20')}" update="coin" />
				<p:commandButton value="0.50" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('0.50')}" update="coin" />
				<p:commandButton value="1.00" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('1.00')}" update="coin" />
				<p:commandButton value="2.00" styleClass="rounded-button"
					action="#{machineBean.incrementCoin('2.00')}" update="coin" />

			</h:panelGrid>

			<p:outputPanel style="margin-top: 5%; float: right;">
				<p:commandButton value="Buy" ajax="false"
					action="#{machineBean.buyCandy}" />
			</p:outputPanel>
		</p:dialog>
	</h:form>

	<!--                        CREATE OR UPDATE CANDY MODAL                                      -->
	<h:form>
		<p:dialog id="createUserModal" modal="true" widgetVar="createCandy"
			resizable="false" stylr="position:absolute;" header="Create Candy"
			style="border-radius: 10px">
			<h:panelGrid columns="2" id="createUserPanel">
	            Name: 
	            <p:inputText id="candyName" value="#{candyBean.name}" />
	            
	            Price: 
	            <p:inputText id="price" value="#{candyBean.price}" />

				Quantity: 
	            <p:inputText id="quantity" value="#{candyBean.quantity}" />
			</h:panelGrid>

			<p:outputPanel style="margin-top: 5%; float: right;">
				<p:commandButton value="Submit" ajax="false"
					action="#{candyBean.createOrUpdateCandy}" />
			</p:outputPanel>
		</p:dialog>
	</h:form>

	<!--                        CONFIRM DELETE MODAL                                      -->
	<h:form>
		<p:dialog id="deleteModal" modal="true" widgetVar="deleteModal"
			resizable="false" stylr="position:absolute;" header="Confirmation"
			style="border-radius: 10px">
			<h:panelGrid columns="2" id="createUserPanel">
			You sure you want to delete?
			</h:panelGrid>

			<p:outputPanel style="margin-top: 5%; float: right;">
				<p:commandButton value="No" ajax="false"
					action="PF('deleteModal').show()" />
				<p:commandButton value="Yes" ajax="false"
					action="#{candyBean.deleteCandy}" />
			</p:outputPanel>
		</p:dialog>
	</h:form>


	<!--                        UPDATE CANDY MODAL                                      -->
	<h:form>
		<p:dialog id="updateModal" modal="true" widgetVar="updateCandy"
			resizable="false" stylr="position:absolute;" header="Update Candy"
			style="border-radius: 10px">
			<h:panelGrid columns="2" id="updateUserPanel">
	            Name: 
	            <p:inputText id="candyName" value="#{candyBean.name}" />
	            
	            Price: 
	            <p:inputText id="price" value="#{candyBean.price}" />

				Quantity: 
	            <p:inputText id="quantity" value="#{candyBean.quantity}" />
			</h:panelGrid>

			<p:outputPanel style="margin-top: 5%; float: right;">
				<p:commandButton value="Submit" ajax="false"
					action="#{candyBean.createOrUpdateCandy}" />
			</p:outputPanel>
		</p:dialog>
	</h:form>
</h:body>
</html>